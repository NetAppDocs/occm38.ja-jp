---
sidebar: sidebar 
permalink: concept_data_tiering.html 
keywords: storage tiering, tier, tiering, data tiering, s3, s3 tiering, capacity, performance, s3 endpoint, fabric pool, fabricpool, s3 bucket, requirement, vpc endpoint, policy, policies, tiering policies, auto, snapshot only, backup, none, cooling period, volume tiering policies, blob, standard, infrequent access, hot, cool, tiering level, storage tier, storage class 
summary: コールドデータを低コストのオブジェクトストレージに自動的に階層化できるため、ストレージコストを削減できます。 
---
= データ階層化の概要
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
使用頻度の低いデータを低コストのオブジェクトストレージに自動的に階層化できるため、ストレージコストを削減できます。アクティブなデータはハイパフォーマンスの SSD または HDD に残り、非アクティブなデータは低コストのオブジェクトストレージに階層化されます。これにより、プライマリストレージのスペースを再利用し、セカンダリストレージを縮小できます。

image:diagram_data_tiering.png["この概念図は、 EBS ストレージに移動中のホットデータと S3 ストレージに移動中の非アクティブデータを示しています。"]

Cloud Volumes ONTAP は、 AWS 、 Azure 、 Google Cloud Platform のデータ階層化をサポートしています。データ階層化は、 FabricPool テクノロジによって実現されます。


NOTE: データの階層化（ FabricPool ）を有効にするために機能ライセンスをインストールする必要はありません。



== AWS でのデータ階層化

AWS でデータ階層化を有効にすると、 Cloud Volumes ONTAP はホットデータのパフォーマンス階層として EBS 、アクセス頻度の低いデータの大容量階層として AWS S3 を使用します。

高パフォーマンス階層:: パフォーマンス階層には、汎用 SSD 、プロビジョニングされた IOPS SSD 、スループットに最適化された HDD があります。
大容量階層::
+
--

NOTE: Cloud Manager は、作業環境ごとに 1 つの S3 バケットを作成して、 fabric-pool-_cluster unique identifier_ という名前を付けます。ボリュームごとに異なる S3 バケットが作成されることはありません。

--
ストレージクラス::
+
--
データにアクセスするとアクセスコストが高くなるため、ストレージクラスを変更する前にこの点を考慮する必要があります。 https://aws.amazon.com/s3/storage-classes["Amazon S3 ストレージクラスに関する詳細情報"^]。

作業環境の作成時にストレージクラスを選択し、あとでいつでも変更できます。ストレージクラスの変更の詳細については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。

データ階層化のストレージクラスは、システム全体に適用されます。ボリューム単位ではありません。

--




== Azure のデータ階層化

Azure でデータ階層化を有効にすると、 Cloud Volumes ONTAP は、ホットデータ用のパフォーマンス階層として Azure で管理されているディスクを、アクセス頻度の低いデータ用の大容量階層として Azure Blob Storage を使用します。

高パフォーマンス階層:: 高パフォーマンス階層には SSD と HDD があります。
大容量階層::
+
--

NOTE: Cloud Manager は、 Cloud Volumes ONTAP 作業環境ごとに 1 つのコンテナを持つ新しいストレージアカウントを作成します。ストレージアカウントの名前はランダムです。ボリュームごとに異なるコンテナは作成されません。

--
ストレージアクセス階層::
+
--
データにアクセスするとアクセスコストが高くなるため、ストレージ階層を変更する前にこの点を考慮する必要があります。 https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-storage-tiers["Azure BLOB ストレージのアクセス階層の詳細については、こちらを参照してください"^]。

作業環境の作成時にストレージ階層を選択し、あとでいつでも変更できます。ストレージ階層の変更の詳細については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。

データ階層化のためのストレージアクセス階層は、システム全体に適用されます。ボリューム単位ではありません。

--




== GCP でのデータ階層化

GCP でデータ階層化を有効にすると、 Cloud Volumes ONTAP はホットデータのパフォーマンス階層として永続的ディスクを使用し、アクセス頻度の低いデータの大容量階層として Google Cloud Storage バケットを使用します。

高パフォーマンス階層:: 高パフォーマンス階層には、 SSD または HDD （標準ディスク）を使用できます。
大容量階層::
+
--

NOTE: Cloud Manager は、作業環境ごとに 1 つのバケットを作成し、 fabric-pool-_cluster unique identifier_ という名前を付けます。ボリュームごとに異なるバケットが作成されることはありません。

--
ストレージクラス::
+
--
データにアクセスするとアクセスコストが高くなるため、ストレージクラスを変更する前にこの点を考慮する必要があります。 https://cloud.google.com/storage/docs/storage-classes["Google Cloud Storage のストレージクラスの詳細については、こちらをご覧ください"^]。

作業環境の作成時にストレージ階層を選択し、あとでいつでも変更できます。ストレージクラスの変更の詳細については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。

データ階層化のストレージクラスは、システム全体に適用されます。ボリューム単位ではありません。

--




== データ階層化と容量の制限

データの階層化を有効にしても、システムの容量制限は変わりません。この制限は、パフォーマンス階層と容量階層に分散されます。



== ボリューム階層化ポリシー

データ階層化を有効にするには、ボリュームの作成、変更、またはレプリケート時にボリューム階層化ポリシーを選択する必要があります。ボリュームごとに異なるポリシーを選択できます。

一部の階層化ポリシーには、最小冷却期間が関連付けられています。この期間は、データを「コールド」と見なして容量階層に移動するために、ボリューム内のユーザーデータを非アクティブのままにする必要がある時間を設定します。

Cloud Manager では、ボリュームを作成または変更するときに、次のボリューム階層化ポリシーのいずれかを選択できます。

Snapshot のみ::
+
--
読み取りの場合、容量階層のコールドデータブロックはホットになり、パフォーマンス階層に移動されます。

--
すべて::
+
--
読み取られた場合、クラウド階層のコールドデータブロックはコールドのままで、パフォーマンス階層に書き戻されません。このポリシーは ONTAP 9.6 以降で使用できます。

--
自動::
+
--
このポリシーは、 Cloud Volumes ONTAP 9.4 以降でサポートされます。

ランダム読み取りで読み取りを行うと、容量階層のコールドデータブロックがホットになり、パフォーマンス階層に移動します。インデックススキャンやアンチウイルススキャンに関連するようなシーケンシャルリードで読み取られた場合、コールドデータブロックはコールド状態を維持し、パフォーマンス階層には移動しません。

--
なし:: ボリュームのデータをパフォーマンス階層に保持し、容量階層に移動できないようにします。


ボリュームをレプリケートする場合、データをオブジェクトストレージに階層化するかどうかを選択できます。このように設定すると、 Cloud Manager は * Backup * ポリシーをデータ保護ボリュームに適用します。Cloud Volumes ONTAP 9.6 以降では、「 * all * 」階層化ポリシーがバックアップポリシーに置き換えられます。



=== Cloud Volumes ONTAP をオフにすると、冷却期間に影響します

データブロックはクーリングスキャンによって冷却されます。このプロセスでは、使用されていないブロックのブロック温度が次の低い値に移動（冷却）されます。デフォルトのクーリング時間は、ボリューム階層化ポリシーによって異なります。

* 自動： 31 日
* Snapshot のみ： 2 日


冷却スキャンが機能するためには、 Cloud Volumes ONTAP が実行されている必要があります。Cloud Volumes ONTAP をオフにすると、冷却も停止します。その結果、冷却にかかる時間が長くなる可能性があります。



== データ階層化の設定

手順およびサポートされている構成の一覧については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。
